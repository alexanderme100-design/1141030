<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <!-- å„ªåŒ– viewport è¨­å®šï¼Œç¦æ­¢ç¸®æ”¾ä»¥æå‡é»æ“Šåæ‡‰é€Ÿåº¦ -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    
    <!-- [æ¥µé‡è¦] é å…ˆå»ºç«‹èˆ‡ Google çš„é€£ç·šï¼ŒåŠ é€Ÿé€å‡ºæ™‚çš„åæ‡‰æ™‚é–“ -->
    <link rel="preconnect" href="https://script.google.com">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    
    <title>æ ¡é•·å¸«å¾’åˆ¶å¯¦æ–½æˆæ•ˆå•å·</title>
    <style>
        /* --- å…¨åŸŸè®Šæ•¸ --- */
        :root {
            --primary-color: #004a99;
            --secondary-color: #0056b3;
            --accent-color: #eef4ff;
            --bg-color: #f4f7f6;
            --card-bg: #ffffff;
            --text-main: #333;
            --text-sub: #555;
            --border-color: #e0e0e0;
            --shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
            --radius: 8px;
        }

        * {
            box-sizing: border-box;
            /* ç§»é™¤æ‰‹æ©Ÿé»æ“Šçš„é«˜äº®è‰²å¡Šï¼Œæ”¹ç”¨è‡ªå®šç¾© CSSï¼Œè¦–è¦ºæ›´æµæš¢ */
            -webkit-tap-highlight-color: transparent;
        }

        html, body {
            margin: 0;
            padding: 0;
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            line-height: 1.6;
            background-color: var(--bg-color);
            color: var(--text-main);
            scroll-behavior: smooth;
            font-size: 16px;
            /* é–‹å•Ÿå­—é«”å¹³æ»‘æ¸²æŸ“ */
            -webkit-font-smoothing: antialiased; 
            -moz-osx-font-smoothing: grayscale;
        }

        header {
            width: 100%;
            background-color: var(--primary-color);
            color: white;
            padding: 1rem;
            text-align: center;
            font-size: 1.3rem;
            font-weight: 700;
            box-shadow: 0 2px 6px rgba(0,0,0,0.15);
            position: sticky;
            top: 0;
            z-index: 1000;
            /* ç¡¬é«”åŠ é€Ÿï¼Œé˜²æ­¢æ»¾å‹•æ™‚é–ƒçˆ */
            transform: translateZ(0); 
        }

        .container {
            max-width: 800px;
            margin: 2rem auto;
            padding: 2rem;
            background-color: var(--card-bg);
            border-radius: var(--radius);
            box-shadow: var(--shadow);
            /* å…§å®¹è®Šæ›´å„ªåŒ– */
            will-change: transform;
        }

        .description {
            background-color: #f8f9fa;
            border-left: 5px solid var(--primary-color);
            padding: 1.2rem;
            margin-bottom: 2rem;
            border-radius: 4px;
        }

        /* --- Fieldset æ¸²æŸ“å„ªåŒ– --- */
        fieldset {
            border: 1px solid var(--border-color);
            border-radius: var(--radius);
            padding: 1.5rem;
            margin-bottom: 2rem;
            background-color: #fff;
            min-width: 0;
            transition: border-color 0.2s;
            /* è®“ç€è¦½å™¨å¯ä»¥è·³éè¢å¹•å¤–å…§å®¹çš„æ¸²æŸ“è¨ˆç®—ï¼Œå¤§å¹…æå‡é•·é é¢æ•ˆèƒ½ */
            content-visibility: auto; 
            contain-intrinsic-size: 1000px; /* é ä¼°é«˜åº¦é˜²æ­¢æ»¾å‹•æ¢è·³å‹• */
        }

        legend {
            font-size: 1.3rem;
            font-weight: 700;
            color: var(--primary-color);
            padding: 0 0.5rem;
            margin-left: 0.5rem;
        }

        .fieldset-basic-info { border-top: 4px solid #0056b3; }
        .fieldset-basic-info legend { color: #0056b3; }
        .fieldset-open-questions { border-top: 4px solid #006437; }
        .fieldset-open-questions legend { color: #006437; }

        .form-group { 
            margin-bottom: 1.8rem; 
            padding: 10px;
            border-radius: 8px;
            transition: background-color 0.2s;
            border: 2px solid transparent;
            scroll-margin-top: 100px;
        }

        .form-group label, .question-text {
            display: block;
            margin-bottom: 0.6rem;
            font-weight: 600;
            font-size: 1.1rem;
        }

        .required { color: #d32f2f; font-weight: bold; margin-left: 4px; }

        /* --- æŒ‰éˆ•å„ªåŒ–ï¼šæ¥µé€ŸéŸ¿æ‡‰ --- */
        .options-group {
            display: flex;
            flex-wrap: wrap;
            gap: 0.6rem;
        }

        .options-group label {
            flex: 1 1 auto;
            min-width: 130px;
            text-align: center;
            padding: 0.7rem 1rem;
            border: 1px solid var(--border-color);
            border-radius: 6px;
            background-color: #fff;
            cursor: pointer;
            /* åŠ å¿«å‹•ç•«é€Ÿåº¦åˆ° 0.1sï¼Œæ„Ÿè¦ºæ›´éˆæ• */
            transition: all 0.1s ease-out; 
            user-select: none;
            display: flex;
            align-items: center;
            justify-content: center;
            min-height: 48px;
            font-size: 1rem;
            /* è§£æ±º iOS é»æ“Šå»¶é² */
            touch-action: manipulation; 
        }

        /* åªæœ‰åœ¨æ”¯æ´ hover çš„è£ç½®ï¼ˆé›»è…¦ï¼‰æ‰é¡¯ç¤º hover æ•ˆæœï¼Œé¿å…æ‰‹æ©Ÿé»æ“Šæ®˜ç•™ */
        @media (hover: hover) {
            .options-group label:hover {
                background-color: var(--accent-color);
                border-color: var(--primary-color);
            }
        }

        /* Active ç‹€æ…‹ï¼šæŒ‰ä¸‹å»ç¬é–“è®Šè‰² */
        .options-group label:active {
            transform: scale(0.98);
            background-color: #e0eaff;
        }

        .options-group input[type="radio"] {
            position: absolute;
            opacity: 0;
            width: 0;
            height: 0;
            pointer-events: none;
        }
        
        .options-group label:has(input[type="radio"]:checked) {
            background-color: var(--primary-color);
            color: white;
            border-color: var(--primary-color);
            font-weight: 600;
            box-shadow: 0 2px 4px rgba(0,74,153,0.25);
            transform: translateY(-1px); /* è¼•å¾®æµ®èµ· */
        }

        /* --- è¼¸å…¥æ¡†å„ªåŒ– --- */
        input[type="text"], select, textarea {
            width: 100%;
            padding: 0.8rem;
            border: 1px solid var(--border-color);
            border-radius: 6px;
            font-size: 16px;
            background-color: #fff;
            transition: box-shadow 0.2s;
            appearance: none; /* ç§»é™¤åŸç”Ÿæ¨£å¼ï¼Œçµ±ä¸€æ˜¯è¦º */
        }
        
        input[type="text"]:focus, select:focus, textarea:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(0, 74, 153, 0.15);
        }

        textarea { resize: vertical; min-height: 120px; }

        /* --- è¡Œæ”¿å€åœ°åœ– --- */
        #districtMap {
            background-color: #fcfcfc;
            padding: 1.2rem;
            border: 1px solid var(--border-color);
            border-radius: 8px;
            scroll-margin-top: 100px;
        }
        
        .district-group { margin-bottom: 1.2rem; }
        .district-group:last-child { margin-bottom: 0; }
        
        .district-label {
            font-size: 0.95rem;
            font-weight: 600;
            color: #555;
            margin-bottom: 0.6rem;
            border-bottom: 1px solid #eee;
            padding-bottom: 0.3rem;
        }

        .district-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(90px, 1fr));
            gap: 0.5rem;
        }

        .district-btn {
            padding: 0.6rem;
            border: 1px solid #ddd;
            border-radius: 6px;
            background-color: #fff;
            cursor: pointer;
            text-align: center;
            font-size: 0.95rem;
            min-height: 44px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.1s ease-out;
            touch-action: manipulation;
        }
        
        @media (hover: hover) {
            .district-btn:hover {
                background-color: var(--accent-color);
                border-color: var(--primary-color);
            }
        }
        
        .district-btn:active { transform: scale(0.96); }

        .district-btn.selected {
            background-color: var(--primary-color);
            color: white;
            border-color: var(--primary-color);
            font-weight: 600;
        }

        /* --- Likert é‡è¡¨ --- */
        .dimension {
            margin-top: 3rem;
            padding: 1.5rem;
            border-radius: 8px;
            border: 1px solid #eee;
            border-left-width: 5px;
            /* åŒæ¨£æ‡‰ç”¨å…§å®¹å¯è¦‹æ€§å„ªåŒ– */
            content-visibility: auto;
            contain-intrinsic-size: 1200px;
        }

        .dimension-1 { background: #f4f9ff; border-left-color: #004a99; }
        .dimension-1 h4 { color: #004a99; }
        .dimension-2 { background: #f2fffa; border-left-color: #00794a; }
        .dimension-2 h4 { color: #00794a; }
        .dimension-3 { background: #fffbf2; border-left-color: #b87400; }
        .dimension-3 h4 { color: #b87400; }
        .dimension-4 { background: #fbf5ff; border-left-color: #5a0099; }
        .dimension-4 h4 { color: #5a0099; }
        .dimension-5 { background: #f2fdfe; border-left-color: #007a7c; }
        .dimension-5 h4 { color: #007a7c; }

        .likert-question {
            padding: 1.2rem 10px;
            border-bottom: 1px dashed #ccc;
            border-radius: 8px;
            transition: background-color 0.2s;
            border: 2px solid transparent;
            scroll-margin-top: 100px;
        }
        .likert-question:last-child { border-bottom: none; }

        .likert-options {
            display: flex;
            justify-content: space-between;
            gap: 0.4rem;
            margin-top: 0.8rem;
        }

        .likert-options label {
            flex: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            text-align: center;
            padding: 0.6rem 0.2rem;
            border: 1px solid #ddd;
            background-color: rgba(255,255,255,0.8);
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.15s cubic-bezier(0.4, 0, 0.2, 1);
            min-height: 60px;
            font-size: 0.9rem;
            touch-action: manipulation;
        }

        .likert-options label .emoji {
            font-size: 1.5rem;
            display: block;
            margin-bottom: 4px;
            filter: grayscale(0.2);
            transition: transform 0.2s, filter 0.2s;
        }

        @media (hover: hover) {
            .likert-options label:hover {
                transform: translateY(-2px);
                box-shadow: 0 3px 6px rgba(0,0,0,0.08);
                background-color: #fff;
                border-color: var(--primary-color);
            }
            .likert-options label:hover .emoji {
                filter: grayscale(0);
                transform: scale(1.15);
            }
        }

        .likert-options label:active { transform: scale(0.96); }

        .likert-options label:has(input[type="radio"]:checked) {
            color: white;
            font-weight: bold;
            transform: scale(1.02);
            box-shadow: 0 4px 10px rgba(0,0,0,0.12);
            border-color: transparent;
        }
        
        .likert-options label:has(input[type="radio"]:checked) .emoji {
            filter: grayscale(0);
            transform: scale(1.15);
        }

        .dimension-1 .likert-options label:has(input[type="radio"]:checked) { background: #004a99; }
        .dimension-2 .likert-options label:has(input[type="radio"]:checked) { background: #00794a; }
        .dimension-3 .likert-options label:has(input[type="radio"]:checked) { background: #b87400; }
        .dimension-4 .likert-options label:has(input[type="radio"]:checked) { background: #5a0099; }
        .dimension-5 .likert-options label:has(input[type="radio"]:checked) { background: #007a7c; }

        .likert-options input[type="radio"] {
            position: absolute;
            opacity: 0;
            width: 0;
            height: 0;
            pointer-events: none;
        }

        /* --- é€å‡ºå€å¡Š --- */
        .submit-container { text-align: center; margin-top: 3rem; padding-bottom: 2rem; }
        
        #submitBtn {
            background-color: var(--secondary-color);
            color: white;
            padding: 1rem 5rem;
            border: none;
            border-radius: 50px;
            font-size: 1.3rem;
            font-weight: 600;
            cursor: pointer;
            box-shadow: 0 4px 12px rgba(0, 86, 179, 0.3);
            transition: all 0.2s ease;
            touch-action: manipulation;
            will-change: transform, box-shadow; /* ç¡¬é«”åŠ é€Ÿ */
        }
        
        @media (hover: hover) {
            #submitBtn:hover {
                background-color: var(--primary-color);
                transform: translateY(-3px);
                box-shadow: 0 6px 16px rgba(0, 74, 153, 0.4);
            }
        }
        
        #submitBtn:active { transform: scale(0.96); box-shadow: 0 2px 4px rgba(0, 74, 153, 0.3); }
        #submitBtn:disabled { background-color: #bbb; cursor: wait; box-shadow: none; transform: none; }

        #loadingSpinner { margin-top: 1rem; font-weight: bold; color: var(--primary-color); }

        #statusMessage { 
            display: none;
            margin-top: 1.5rem; 
            padding: 1rem; 
            border-radius: 8px; 
            font-weight: bold; 
            text-align: center;
            animation: fadeIn 0.3s ease-out;
        }
        
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        
        .success { background-color: #d4edda; color: #155724; border: 1px solid #c3e6cb; }
        .error { background-color: #ffebee; color: #c62828; border: 1px solid #ef9a9a; }

        /* --- éŒ¯èª¤æç¤ºå‹•ç•« --- */
        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            20% { transform: translateX(-6px); }
            40% { transform: translateX(6px); }
            60% { transform: translateX(-3px); }
            80% { transform: translateX(3px); }
        }

        .highlight-error {
            animation: shake 0.4s cubic-bezier(.36,.07,.19,.97) both;
            border: 2px solid #d32f2f !important;
            background-color: #fff5f5 !important;
            box-shadow: 0 0 0 4px rgba(211, 47, 47, 0.1) !important;
        }

        /* --- RWD æ‰‹æ©Ÿç‰ˆ --- */
        @media (max-width: 768px) {
            .container { margin: 0; padding: 1rem; border-radius: 0; box-shadow: none; }
            header { padding: 1rem; font-size: 1.2rem; }
            fieldset { padding: 1.2rem; margin-bottom: 1.5rem; }
            legend { font-size: 1.2rem; }
            .form-group label { font-size: 1.1rem; }
            /* æ‰‹æ©Ÿç‰ˆæŒ‰éˆ•æ”¹ç‚ºå……æ»¿æ•´è¡Œæˆ–åŠè¡Œï¼Œå¢åŠ é»æ“Šé¢ç© */
            .options-group label { flex: 1 1 45%; padding: 0.8rem 0.5rem; font-size: 0.95rem; }
            
            .district-grid { grid-template-columns: repeat(auto-fill, minmax(85px, 1fr)); }
            
            /* Likert æ‰‹æ©Ÿç›´æ’ */
            .likert-options { flex-direction: column; gap: 0.6rem; }
            .likert-options label { 
                flex-direction: row; 
                justify-content: flex-start; 
                padding: 1rem 1.2rem; 
                text-align: left; 
                border-radius: 8px; 
                background-color: #fff; 
                border: 1px solid #e0e0e0; 
            }
            .likert-options label .emoji { display: inline; margin-bottom: 0; margin-right: 12px; font-size: 1.4rem; vertical-align: middle; }
            
            /* æ¨¡æ“¬ Radio åœ“é» */
            .likert-options label::before { content: ""; display: inline-block; width: 20px; height: 20px; border-radius: 50%; border: 2px solid #ccc; margin-right: 12px; transition: all 0.2s; flex-shrink: 0; }
            .likert-options label:has(input[type="radio"]:checked)::before { border-color: #fff; background-color: #fff; box-shadow: inset 0 0 0 5px var(--primary-color); }
            
            .likert-options label:has(input[type="radio"]:checked) { transform: none; border-color: transparent; }
            
            #submitBtn { width: 100%; border-radius: 12px; padding: 1.1rem; font-size: 1.2rem; }
        }
    </style>

    <script>
        // é å…ˆè¼‰å…¥ç”Ÿæˆ HTMLï¼Œæ¯” JS å‹•æ…‹ç”Ÿæˆç¨å¾®å¿«ä¸€é»é»
        function createLikert(name, questionText) {
            return `
            <div class="likert-question">
                <p class="question-text">${questionText} <span class="required">*</span></p>
                <div class="likert-options">
                    <label><input type="radio" name="${name}" value="7" required> <span class="emoji">ğŸ¤©</span>(7) æ¥µç‚ºåŒæ„</label>
                    <label><input type="radio" name="${name}" value="6" required> <span class="emoji">ğŸ˜Š</span>(6) å¾ˆåŒæ„</label>
                    <label><input type="radio" name="${name}" value="5" required> <span class="emoji">ğŸ™‚</span>(5) åŒæ„</label>
                    <label><input type="radio" name="${name}" value="4" required> <span class="emoji">ğŸ˜</span>(4) æ™®é€š</label>
                    <label><input type="radio" name="${name}" value="3" required> <span class="emoji">ğŸ™</span>(3) ä¸åŒæ„</label>
                    <label><input type="radio" name="${name}" value="2" required> <span class="emoji">ğŸ˜ </span>(2) å¾ˆä¸åŒæ„</label>
                    <label><input type="radio" name="${name}" value="1" required> <span class="emoji">ğŸ˜¡</span>(1) æ¥µä¸åŒæ„</label>
                </div>
            </div>`;
        }
    </script>
</head>
<body>

    <header>ä¸­å°å­¸éšæ®µæ ¡é•·å¸«å¾’åˆ¶å¯¦æ–½æˆæ•ˆå•å·V3</header>

    <div class="container">
        <div class="description">
            <p><strong>æ•¬æ„›çš„æ ¡é•·æ‚¨å¥½ï¼š</strong></p>
            <p>é€™æ˜¯ä¸€ä»½æœ‰é—œæ ¡é•·å¸«å¾’åˆ¶å¯¦æ–½æˆæ•ˆçš„å•å·ï¼Œå¸Œæœ›å€Ÿé‡æ‚¨çš„æ™ºæ…§èˆ‡ç¶“é©—ï¼Œå°±æ‚¨å¯¦éš›çš„ç¶“é©—ä¾ç¬¦åˆç¨‹åº¦ä¾†æª¢è¦–é€™äº›é¡Œç›®ã€‚</p>
            <p>æœ¬å•å·æ—¨åœ¨æ·±å…¥äº†è§£ä¸­å°å­¸éšæ®µæ ¡é•·å°æ–¼ã€Œæ ¡é•·å¸«å¾’åˆ¶ã€çš„çœ‹æ³•èˆ‡æ„Ÿå—ç¨‹åº¦ã€‚æ‚¨çš„å¯¶è²´æ„è¦‹å°‡æ˜¯æœªä¾†ç›¸é—œæ”¿ç­–ç ”æ“¬èˆ‡å¯¦å‹™æ¨å‹•çš„é‡è¦åƒè€ƒã€‚</p>
        </div>

        <form id="surveyForm">
            <!-- å£¹ã€åŸºæœ¬è³‡æ–™ -->
            <fieldset class="fieldset-basic-info">
                <legend>å£¹ã€åŸºæœ¬è³‡æ–™</legend>
                <p class="question-note">èªªæ˜ï¼šè«‹ä¾æ“šæ‚¨çš„è³‡æ–™ç‹€æ³ï¼Œå‹¾é¸æœ€ç¬¦åˆçš„ç­”æ¡ˆã€‚(<span class="required">*</span> ç‚ºå¿…å¡«)</p>

                <div class="form-group">
                    <label>æ€§åˆ¥ <span class="required">*</span></label>
                    <div class="options-group">
                        <label><input type="radio" name="gender" value="ç”·" required> ç”·</label>
                        <label><input type="radio" name="gender" value="å¥³" required> å¥³</label>
                    </div>
                </div>

                <div class="form-group">
                    <label>å¹´é½¡ <span class="required">*</span></label>
                    <div class="options-group">
                        <label><input type="radio" name="age" value="30æ­²ï¼ˆå«ï¼‰ä»¥ä¸‹" required> 30æ­²ï¼ˆå«ï¼‰ä»¥ä¸‹</label>
                        <label><input type="radio" name="age" value="31-40æ­²" required> 31-40æ­²</label>
                        <label><input type="radio" name="age" value="41-50æ­²" required> 41-50æ­²</label>
                        <label><input type="radio" name="age" value="51æ­²-60æ­²" required> 51æ­²-60æ­²</label>
                        <label><input type="radio" name="age" value="61æ­²ä»¥ä¸Š" required> 61æ­²ä»¥ä¸Š</label>
                    </div>
                </div>

                <div class="form-group">
                    <label>æœ€é«˜å­¸æ­· <span class="required">*</span></label>
                    <div class="options-group">
                        <label><input type="radio" name="education" value="å­¸å£«" required> å­¸å£«</label>
                        <label><input type="radio" name="education" value="ç¢©å£«ï¼ˆå«40å­¸åˆ†ç­ï¼‰" required> ç¢©å£«ï¼ˆå«40å­¸åˆ†ç­ï¼‰</label>
                        <label><input type="radio" name="education" value="åšå£«" required> åšå£«</label>
                    </div>
                </div>

                <div class="form-group">
                    <label>æ“”ä»»æ ¡é•·ç¸½å¹´è³‡ <span class="required">*</span></label>
                    <div class="options-group">
                        <label><input type="radio" name="seniority" value="4å¹´ï¼ˆå«ï¼‰ä»¥ä¸‹" required> 4å¹´ï¼ˆå«ï¼‰ä»¥ä¸‹</label>
                        <label><input type="radio" name="seniority" value="5-8å¹´" required> 5-8å¹´</label>
                        <label><input type="radio" name="seniority" value="9-12å¹´" required> 9-12å¹´</label>
                        <label><input type="radio" name="seniority" value="13å¹´ï¼ˆå«ï¼‰ä»¥ä¸Š" required> 13å¹´ï¼ˆå«ï¼‰ä»¥ä¸Š</label>
                    </div>
                </div>

                <div class="form-group">
                    <label>æœå‹™å­¸æ ¡éšæ®µåˆ¥ <span class="required">*</span></label>
                    <div class="options-group">
                        <label><input type="radio" name="schoolLevel" value="åœ‹å°" required> åœ‹å°</label>
                        <label><input type="radio" name="schoolLevel" value="åœ‹ä¸­" required> åœ‹ä¸­</label>
                        <label><input type="radio" name="schoolLevel" value="é«˜ä¸­è·" required> é«˜ä¸­è·</label>
                    </div>
                </div>

                <div class="form-group">
                    <label>å­¸æ ¡è¦æ¨¡ <span class="required">*</span></label>
                    <div class="options-group">
                        <label><input type="radio" name="schoolSize" value="12ç­ï¼ˆå«ï¼‰ä»¥ä¸‹" required> 12ç­ï¼ˆå«ï¼‰ä»¥ä¸‹</label>
                        <label><input type="radio" name="schoolSize" value="13-24ç­" required> 13-24ç­</label>
                        <label><input type="radio" name="schoolSize" value="25-47ç­" required> 25-47ç­</label>
                        <label><input type="radio" name="schoolSize" value="48ç­ä»¥ä¸Š" required> 48ç­ä»¥ä¸Š</label>
                    </div>
                </div>

                <div class="form-group">
                    <label>å­¸æ ¡æ‰€åœ¨åœ°å€ <span class="required">*</span></label>
                    <div class="options-group">
                        <label><input type="radio" name="schoolRegion" value="éƒ½å¸‚å‹" required> éƒ½å¸‚å‹</label>
                        <label><input type="radio" name="schoolRegion" value="é„‰é®å‹" required> é„‰é®å‹</label>
                        <label><input type="radio" name="schoolRegion" value="åé æˆ–é›¢å³¶å‹" required> åé æˆ–é›¢å³¶å‹</label>
                    </div>
                </div>

                <div class="form-group">
                    <label for="schoolDistrict">å­¸æ ¡æ‰€å±¬è¡Œæ”¿å€ <span class="required">*</span></label>
                    <input type="hidden" id="schoolDistrict" name="schoolDistrict" value="" required>
                    <div id="districtMap">
                        <div class="district-group">
                            <div class="district-label">ç›´è½„å¸‚</div>
                            <div class="district-grid">
                                <div class="district-btn" data-value="è‡ºåŒ—å¸‚">è‡ºåŒ—å¸‚</div>
                                <div class="district-btn" data-value="æ–°åŒ—å¸‚">æ–°åŒ—å¸‚</div>
                                <div class="district-btn" data-value="æ¡ƒåœ’å¸‚">æ¡ƒåœ’å¸‚</div>
                                <div class="district-btn" data-value="è‡ºä¸­å¸‚">è‡ºä¸­å¸‚</div>
                                <div class="district-btn" data-value="è‡ºå—å¸‚">è‡ºå—å¸‚</div>
                                <div class="district-btn" data-value="é«˜é›„å¸‚">é«˜é›„å¸‚</div>
                            </div>
                        </div>
                        <div class="district-group">
                            <div class="district-label">ç¸£</div>
                            <div class="district-grid">
                                <div class="district-btn" data-value="æ–°ç«¹ç¸£">æ–°ç«¹ç¸£</div>
                                <div class="district-btn" data-value="è‹—æ —ç¸£">è‹—æ —ç¸£</div>
                                <div class="district-btn" data-value="å½°åŒ–ç¸£">å½°åŒ–ç¸£</div>
                                <div class="district-btn" data-value="å—æŠ•ç¸£">å—æŠ•ç¸£</div>
                                <div class="district-btn" data-value="é›²æ—ç¸£">é›²æ—ç¸£</div>
                                <div class="district-btn" data-value="å˜‰ç¾©ç¸£">å˜‰ç¾©ç¸£</div>
                                <div class="district-btn" data-value="å±æ±ç¸£">å±æ±ç¸£</div>
                                <div class="district-btn" data-value="å®œè˜­ç¸£">å®œè˜­ç¸£</div>
                                <div class="district-btn" data-value="èŠ±è“®ç¸£">èŠ±è“®ç¸£</div>
                                <div class="district-btn" data-value="è‡ºæ±ç¸£">è‡ºæ±ç¸£</div>
                                <div class="district-btn" data-value="æ¾æ¹–ç¸£">æ¾æ¹–ç¸£</div>
                                <div class="district-btn" data-value="é‡‘é–€ç¸£">é‡‘é–€ç¸£</div>
                                <div class="district-btn" data-value="é€£æ±Ÿç¸£">é€£æ±Ÿç¸£</div>
                            </div>
                        </div>
                        <div class="district-group">
                            <div class="district-label">å¸‚ (çœè½„å¸‚)</div>
                            <div class="district-grid">
                                <div class="district-btn" data-value="åŸºéš†å¸‚">åŸºéš†å¸‚</div>
                                <div class="district-btn" data-value="æ–°ç«¹å¸‚">æ–°ç«¹å¸‚</div>
                                <div class="district-btn" data-value="å˜‰ç¾©å¸‚">å˜‰ç¾©å¸‚</div>
                            </div>
                        </div>
                    </div>
                    <div id="districtError" style="color: #d32f2f; font-size: 0.95rem; display: none; margin-top: 8px; font-weight: 600;">è«‹é¸æ“‡ä¸€å€‹è¡Œæ”¿å€ã€‚</div>
                </div>

                <div class="form-group">
                    <label>æ‚¨æ˜¯å¦æ›¾åƒèˆ‡å¸«å¾’åˆ¶åº¦ <span class="required">*</span></label>
                    <div class="options-group">
                        <label><input type="radio" name="hasMentorship" value="æ˜¯" required> æ˜¯</label>
                        <label><input type="radio" name="hasMentorship" value="å¦" required> å¦</label>
                    </div>
                </div>

                <div class="form-group">
                    <label>æ‚¨æ›¾åƒèˆ‡å¸«å¾’åˆ¶åº¦é…å°æ–¹å¼ç‚ºä½• <span class="required">*</span></label>
                    <div class="options-group">
                        <label><input type="radio" name="mentorshipType" value="æ­£å¼å®˜æ–¹å¸«å¾’åˆ¶" required> æ­£å¼å®˜æ–¹å¸«å¾’åˆ¶</label>
                        <label><input type="radio" name="mentorshipType" value="éæ­£å¼å›ºå®šå¸«å¾’é—œä¿‚" required> éæ­£å¼å›ºå®šå¸«å¾’é—œä¿‚</label>
                        <label><input type="radio" name="mentorshipType" value="åŒå„•æ•™ç·´/å­¸ç¿’ç¤¾ç¾¤" required> åŒå„•æ•™ç·´/å­¸ç¿’ç¤¾ç¾¤</label>
                        <label><input type="radio" name="mentorshipType" value="å°šæœªåƒèˆ‡" required> å°šæœªåƒèˆ‡</label>
                    </div>
                </div>
            </fieldset>

            <!-- è²³ã€é‡è¡¨ -->
            <fieldset>
                <legend>è²³ã€æ ¡é•·å¸«å¾’åˆ¶å¯¦æ–½æˆæ•ˆé‡è¡¨</legend>
                <div class="description">
                    <p><strong>èªªæ˜ï¼š</strong>è«‹æ‚¨å°ã€ ä¸­å°å­¸éšæ®µ æ ¡é•·å¸«å¾’åˆ¶å¯¦æ–½æˆæ•ˆã€‘å•å·ï¼Œå…±äº”å€‹å‘åº¦çš„åŒæ„ç¨‹åº¦ï¼Œä¾å€‹äººèªåŒç¨‹åº¦åœ¨â–¡å…§æ‰“ã€Œã€ã€‚(<span class="required">*</span> ç‚ºå¿…å¡«)</p>
                </div>
                
                <div class="likert-options" style="padding: 0.5rem 1rem; background: #f9f9f9; border-radius: 4px; margin-bottom: 1.5rem; justify-content: space-around; flex-wrap: wrap;">
                    <span style="font-size: 0.9rem;"><span class="emoji">ğŸ¤©</span>(7) æ¥µç‚ºåŒæ„</span>
                    <span style="font-size: 0.9rem;"><span class="emoji">ğŸ˜Š</span>(6) å¾ˆåŒæ„</span>
                    <span style="font-size: 0.9rem;"><span class="emoji">ğŸ™‚</span>(5) åŒæ„</span>
                    <span style="font-size: 0.9rem;"><span class="emoji">ğŸ˜</span>(4) æ™®é€š</span>
                    <span style="font-size: 0.9rem;"><span class="emoji">ğŸ™</span>(3) ä¸åŒæ„</span>
                    <span style="font-size: 0.9rem;"><span class="emoji">ğŸ˜ </span>(2) å¾ˆä¸åŒæ„</span>
                    <span style="font-size: 0.9rem;"><span class="emoji">ğŸ˜¡</span>(1) æ¥µä¸åŒæ„</span>
                </div>

                <!-- å‘åº¦ä¸€ -->
                <div class="dimension dimension-1">
                    <h4>å‘åº¦ä¸€ï¼šæ ¡å‹™ç¶“ç‡Ÿèˆ‡å±æ©Ÿè™•ç†</h4>
                    <p class="question-note">å®šç¾©ï¼šæœ¬å‘åº¦èšç„¦æ–¼å¸«å‚…æ ¡é•·åœ¨å”åŠ©åˆä»»æ ¡é•·æ‡‰å°ã€Œæ ¡å‹™ç¶“ç‡Ÿã€å…¨è²Œçš„æŒ‡å°æˆæ•ˆã€‚</p>
                    
                    <script>
                       const qA = [
                         "1. å¸«å‚…æ ¡é•·èƒ½æä¾›åˆä»»æ ¡é•·å­¸æ ¡ç¸½å‹™è¡Œæ”¿äº‹å‹™çš„å°ˆæ¥­æŒ‡å°ã€‚",
                         "2. å¸«å‚…æ ¡é•·èƒ½å¼•å°åˆä»»æ ¡é•·åšæœ‰æ•ˆçš„æ™‚é–“ç®¡ç†ï¼Œæå‡è¡Œæ”¿è™•ç†æ•ˆèƒ½ã€‚",
                         "3. å¸«å‚…æ ¡é•·èƒ½å¼•å°åˆä»»æ ¡é•·å»ºç«‹å…¨æ–¹ä½çš„æ ¡åœ’å®‰å…¨ç®¡ç†ç³»çµ±ã€‚",
                         "4. å¸«å‚…æ ¡é•·èƒ½æå‡åˆä»»æ ¡é•·åœ¨é‡å¤§å£“åŠ›æƒ…å¢ƒä¸­çš„ç­–ç•¥æ€§æ±ºç­–èƒ½åŠ›ã€‚",
                         "5. å¸«å‚…æ ¡é•·èƒ½æå‡åˆä»»æ ¡é•·åœ¨å±æ©Ÿäº‹ä»¶ä¸­çš„æ•´åˆæ€§è™•ç†èƒ½åŠ›ã€‚",
                         "6. å¸«å‚…æ ¡é•·èƒ½å¼•å°åˆä»»æ ¡é•·åœ¨æ ¡åœ’å®‰å…¨äº‹ä»¶ä¸­ï¼Œç†Ÿç¨”æ¨™æº–ä½œæ¥­è™•ç†æµç¨‹ã€‚",
                         "7. å¸«å‚…æ ¡é•·èƒ½å¼•å°åˆä»»æ ¡é•·é€²è¡Œæ ¡å…§æœ‰é™è³‡æºçš„ç­–ç•¥æ€§åˆ†é…åŠé‹ç”¨ã€‚",
                         "8. å¸«å‚…æ ¡é•·èƒ½å¼•å°åˆä»»æ ¡é•·å¾éŒ¯èª¤æ±ºç­–ä¸­é€²è¡Œäº‹å¾Œæª¢è¨æ±²å–ç¶“é©—ã€‚",
                         "9. å¸«å‚…æ ¡é•·èƒ½å¼•å°åˆä»»æ ¡é•·é‹ç”¨æœ‰æ•ˆçš„æˆæ¬Šç­–ç•¥ï¼Œä»¥ä¿ƒé€²å­¸æ ¡è¡Œæ”¿é †æš¢é‹ä½œã€‚",
                         "10. å¸«å‚…æ ¡é•·èƒ½å¼•å°åˆä»»æ ¡é•·åœ¨å±æ©Ÿå¾Œï¼Œå¦¥é©å®‰æ’«å¸«ç”Ÿæƒ…ç·’çš„è¼”å°ã€‚"
                       ];
                       qA.forEach((t, i) => document.write(createLikert(`A${i+1}`, t)));
                    </script>
                </div>

                <!-- å‘åº¦äºŒ -->
                <div class="dimension dimension-2">
                    <h4>å‘åº¦äºŒï¼šå¸«å¾’é—œä¿‚èˆ‡é—œæ‡·æ”¯æŒ</h4>
                    <p class="question-note">å®šç¾©ï¼šæœ¬å‘åº¦èšç„¦æ–¼å¸«å¾’äº’å‹•çš„å“è³ªèˆ‡æƒ…æ„ŸåŠŸèƒ½ã€‚</p>
                    <script>
                        const qB = [
                            "1. å¸«å‚…æ ¡é•·èˆ‡åˆä»»æ ¡é•·æœ‰è‰¯å¥½çš„ä¿¡ä»»é—œä¿‚ã€‚",
                            "2. å¸«å‚…æ ¡é•·èˆ‡åˆä»»æ ¡é•·æœ‰å®‰å…¨ä¿¡è³´çš„äº’å‹•æ°›åœï¼Œå¯ä»¥å¦èª äº¤æµã€‚",
                            "3. å¸«å‚…æ ¡é•·èˆ‡åˆä»»æ ¡é•·åœ¨äº’å‹•éç¨‹ä¸­ï¼Œèƒ½å½¼æ­¤ç›¸äº’å‚¾è½èˆ‡å°Šé‡ã€‚",
                            "4. å¸«å‚…æ ¡é•·æœ‰åŒç†å¿ƒï¼Œæä¾›åˆä»»æ ¡é•·æº«æš–ä¸”æœ‰æ•ˆçš„æƒ…æ„Ÿæ”¯æŒã€‚",
                            "5. å¸«å‚…æ ¡é•·èƒ½æœ‰æ•ˆç·©è§£åˆä»»æ ¡é•·çš„å­¤ç«‹æ„Ÿèˆ‡å·¥ä½œç„¦æ…®ã€‚",
                            "6. å¸«å‚…æ ¡é•·èƒ½æå‡åˆä»»æ ¡é•·çš„å·¥ä½œæ»¿æ„åº¦ã€‚",
                            "7. å¸«å‚…æ ¡é•·èƒ½ä¸»å‹•é—œæ‡·åˆä»»æ ¡é•·çš„èº«å¿ƒå¥åº·ï¼Œå±•ç¾å‡ºå…¬äº‹å¤–çš„æ”¯æŒã€‚",
                            "8. å¸«å‚…æ ¡é•·èƒ½å¹«åŠ©åˆä»»æ ¡é•·æ‡‰å°æœ€å…·æŒ‘æˆ°æ€§çš„å·¥ä½œå£“åŠ›ã€‚",
                            "9. å¸«å‚…æ ¡é•·æ‰€ç‡Ÿé€ çš„é—œä¿‚æ°›åœï¼Œè®“åˆä»»æ ¡é•·ç„¡å¾Œé¡§ä¹‹æ†‚å°‹æ±‚å”åŠ©èˆ‡æŒ‡å°ã€‚",
                            "10. å¸«å‚…æ ¡é•·èƒ½çµ¦äºˆç©æ¥µè‚¯å®šèˆ‡è³¦èƒ½ï¼Œå¼·åŒ–åˆä»»æ ¡é•·è¾¦å­¸è‡ªä¿¡å¿ƒã€‚"
                        ];
                        qB.forEach((t, i) => document.write(createLikert(`B${i+1}`, t)));
                    </script>
                </div>

                <!-- å‘åº¦ä¸‰ -->
                <div class="dimension dimension-3">
                    <h4>å‘åº¦ä¸‰ï¼šæ•™å­¸é ˜å°èˆ‡æ–‡åŒ–å¡‘é€ </h4>
                    <p class="question-note">å®šç¾©ï¼šæœ¬å‘åº¦æ—¨åœ¨æª¢è¦–å¸«å‚…æ ¡é•·åœ¨å”åŠ©åˆä»»æ ¡é•·ç™¼å±•æ•™å­¸é ˜å°ã€è¨­å®šæ•™å­¸æ–¹å‘ç­‰æ ¸å¿ƒæ•™è‚²å·¥ä½œçš„æˆæ•ˆã€‚</p>
                     <script>
                        const qC = [
                            "1. å¸«å‚…æ ¡é•·èƒ½å¼•å°åˆä»»æ ¡é•·ç™¼å±•èª²ç¨‹èˆ‡æ•™å­¸é ˜å°çš„å°ˆæ¥­èƒ½åŠ›ã€‚",
                            "2. å¸«å‚…æ ¡é•·èƒ½å¼•å°åˆä»»æ ¡é•·é‡å®šå­¸æ ¡æ•™å­¸ç™¼å±•æ–¹å‘ã€‚",
                            "3. å¸«å‚…æ ¡é•·èƒ½å¼•å°åˆä»»æ ¡é•·ç™¼å±•å¯¦è¸å­¸æ ¡é¡˜æ™¯èˆ‡ç‰¹è‰²ã€‚",
                            "4. å¸«å‚…æ ¡é•·èƒ½æä¾›åˆä»»æ ¡é•·å½¢å¡‘æˆ–è½‰åŒ–å­¸æ ¡çµ„ç¹”æ–‡åŒ–çš„æœ‰æ•ˆç­–ç•¥ã€‚",
                            "5. å¸«å‚…æ ¡é•·èƒ½å¼•å°åˆä»»æ ¡é•·æ“¬å®šæœ‰æ•ˆæ¨å‹•å­¸æ ¡æ•™å­¸å“è³ªæ”¹é€²è¨ˆç•«ã€‚",
                            "6. å¸«å‚…æ ¡é•·èƒ½å¼•å°åˆä»»æ ¡é•·é€éç³»çµ±æ€§çš„æ•™å¸«å°ˆæ¥­ç™¼å±•ï¼Œç‡Ÿé€ æ ¡åœ’çš„å­¸ç¿’å‹çµ„ç¹”æ–‡åŒ–ã€‚",
                            "7. å¸«å‚…æ ¡é•·èƒ½æä¾›æœ‰æ•ˆçš„æ¿€å‹µç­–ç•¥ï¼Œä»¥æå‡æ•™å¸«çš„å°ˆæ¥­æŠ•å…¥èˆ‡å‹•æ©Ÿã€‚",
                            "8. å¸«å‚…æ ¡é•·èƒ½å¼•å°åˆä»»æ ¡é•·ç‡Ÿé€ ä¸€å€‹æ­£å‘ç©æ¥µçš„å­¸æ ¡æ–‡åŒ–ã€‚",
                            "9. å¸«å‚…æ ¡é•·èƒ½å¼•å°åˆä»»æ ¡é•·èª¿æ•´å­¸æ ¡çµ„ç¹”æ¶æ§‹ï¼Œä»¥æœ‰æ•ˆæ”¯æŒæ ¸å¿ƒæ•™å­¸ä»»å‹™ã€‚",
                            "10. å¸«å‚…æ ¡é•·èƒ½å¼•å°åˆä»»æ ¡é•·å–„ç”¨å½±éŸ¿åŠ›ï¼Œå¾ªåºæ¼¸é€²åœ°æ¨å‹•æ•™å­¸è®Šé©ã€‚"
                        ];
                        qC.forEach((t, i) => document.write(createLikert(`C${i+1}`, t)));
                    </script>
                </div>

                <!-- å‘åº¦å›› -->
                <div class="dimension dimension-4">
                    <h4>å‘åº¦å››ï¼šäººéš›æºé€šèˆ‡é—œä¿‚å»ºç«‹</h4>
                    <p class="question-note">å®šç¾©ï¼šæœ¬å‘åº¦æ—¨åœ¨è©•ä¼°å¸«å‚…æ ¡é•·åœ¨æŒ‡å°åˆä»»æ ¡é•·å¦‚ä½•èˆ‡åˆ©å®³é—œä¿‚äººå»ºç«‹è‰¯å¥½é—œä¿‚çš„æˆæ•ˆã€‚</p>
                    <script>
                        const qD = [
                            "1. å¸«å‚…æ ¡é•·èƒ½å¼•å°åˆä»»æ ¡é•·èˆ‡æ ¡å…§å¤–é—œéµåˆ©å®³é—œä¿‚äººï¼Œå»ºç«‹æ­£å‘çš„ä¿¡ä»»é—œä¿‚ã€‚",
                            "2. å¸«å‚…æ ¡é•·èƒ½å¼•å°åˆä»»æ ¡é•·é‹ç”¨æœ‰æ•ˆçš„æºé€šç­–ç•¥ï¼Œä»¥ä¿ƒé€²åŒä»é–“çš„å°ˆæ¥­å°è©±èˆ‡åˆä½œã€‚",
                            "3. å¸«å‚…æ ¡é•·èƒ½å¼•å°åˆä»»æ ¡é•·å±•ç¾æœ‰æ•ˆçš„åœ˜éšŠé ˜å°åŠ›ï¼Œä»¥å‡èšå…±è­˜ä¸¦ææŒ¯å£«æ°£ã€‚",
                            "4. å¸«å‚…æ ¡é•·èƒ½å¼•å°åˆä»»æ ¡é•·å»ºç«‹æ ¡å…§æ­£å‘çš„æºé€šæ©Ÿåˆ¶ï¼Œç‡Ÿé€ çµ„ç¹”å…§çš„äº’ä¿¡æ°›åœã€‚",
                            "5. å¸«å‚…æ ¡é•·èƒ½å¼•å°åˆä»»æ ¡é•·æœ‰æ•ˆè™•ç†è¦ªå¸«ç”Ÿä¹‹é–“çš„äº’å‹•è­°é¡Œï¼Œä»¥å»ºç«‹ç©©å›ºçš„æ•™è‚²å¤¥ä¼´é—œä¿‚ã€‚",
                            "6. å¸«å‚…æ ¡é•·èƒ½å¼•å°åˆä»»æ ¡é•·é€éè³¦æ¬Šå¢èƒ½ï¼Œä¾†æå‡è¡Œæ”¿åœ˜éšŠçš„æ•´é«”åˆä½œæ•ˆèƒ½ã€‚",
                            "7. å¸«å‚…æ ¡é•·èƒ½å¼•å°åˆä»»æ ¡é•·æœ‰æ•ˆç¶“ç‡Ÿèˆ‡æ ¡å…§å¤–ç¤¾ç¾¤çš„å’Œè«§é—œä¿‚ã€‚",
                            "8. å¸«å‚…æ ¡é•·èƒ½æä¾›å»ºç«‹ç©©å›ºè¦ªå¸«åˆä½œå¤¥ä¼´é—œä¿‚çš„æœ‰æ•ˆç­–ç•¥ã€‚",
                            "9. å¸«å‚…æ ¡é•·èƒ½å¼•å°åˆä»»æ ¡é•·ä»¥å…¬å¹³ã€å¯©æ…çš„åŸå‰‡ï¼Œè™•ç†æ•™è·å“¡çš„äººäº‹è­°é¡Œã€‚",
                            "10. å¸«å‚…æ ¡é•·èƒ½å¼•å°åˆä»»æ ¡é•·èˆ‡ä¸»ç®¡æ©Ÿé—œåŠæ˜”æ—¥åŒä»å»ºç«‹æœ‰æ•ˆçš„å·¥ä½œé—œä¿‚ã€‚"
                        ];
                        qD.forEach((t, i) => document.write(createLikert(`D${i+1}`, t)));
                    </script>
                </div>

                <!-- å‘åº¦äº” -->
                <div class="dimension dimension-5">
                    <h4>å‘åº¦äº”ï¼šå°ˆæ¥­åæ€èˆ‡è‡ªä¸»æˆé•·</h4>
                    <p class="question-note">å®šç¾©ï¼šæœ¬å‘åº¦æ—¨åœ¨æ¢è¨å¸«å¾’åˆ¶æ˜¯å¦èƒ½å¼•å°åˆä»»æ ¡é•·é€²è¡Œæ·±å±¤å•é¡Œè¨ºæ–·ã€åæ€æ€§æ€è€ƒã€‚</p>
                    <script>
                        const qE = [
                            "1. å¸«å‚…æ ¡é•·èƒ½å¼•å°åˆä»»æ ¡é•·é‹ç”¨åæ€æ€§æå•ï¼Œæ·±å…¥è¨ºæ–·å•é¡Œæ ¹æºã€‚",
                            "2. å¸«å‚…æ ¡é•·èƒ½æå‡åˆä»»æ ¡é•·åœ¨è¤‡é›œæƒ…å¢ƒçš„åæ€èˆ‡æ´å¯Ÿèƒ½åŠ›ã€‚",
                            "3. å¸«å‚…æ ¡é•·èƒ½æå‡åˆä»»æ ¡é•·çš„å°ˆæ¥­è‡ªä¸»æ€§ã€ç¨ç«‹å­¸ç¿’åŠè§£æ±ºå•é¡Œçš„èƒ½åŠ›ã€‚",
                            "4. å¸«å‚…æ ¡é•·èƒ½å¼•å°åˆä»»æ ¡é•·åœ¨é ˜å°å°ˆæ¥­æŠ€èƒ½ä¸Šçš„å¯¦è³ªæˆé•·ã€‚",
                            "5. å¸«å‚…æ ¡é•·èƒ½å¼•å°åˆä»»æ ¡é•·å¾å¤šå…ƒè¦–è§’åˆ†ææ–¹æ¡ˆåˆ©å¼Šã€‚",
                            "6. å¸«å‚…æ ¡é•·èƒ½å”åŠ©åˆä»»æ ¡é•·å¾å¯¦å‹™ç¶“é©—ä¸­å½°é¡¯å€‹äººçš„é ˜å°å“²å­¸ã€‚",
                            "7. å¸«å‚…æ ¡é•·èƒ½å¼•å°åˆä»»æ ¡é•·é‹ç”¨ç³»çµ±æ€§æ€è€ƒä¾†åˆ†æèˆ‡è§£æ±ºå•é¡Œã€‚",
                            "8. å¸«å‚…æ ¡é•·èƒ½å¼•å°åˆä»»æ ¡é•·ï¼Œå°‡å€‹äººå°ˆæ¥­ç™¼å±•èˆ‡å­¸æ ¡æ°¸çºŒç™¼å±•çš„ç›®æ¨™ç›¸çµåˆã€‚",
                            "9. å¸«å‚…æ ¡é•·èƒ½å¼•å°åˆä»»æ ¡é•·åœ¨è¡Œæ”¿å¯¦å‹™ä¸­ï¼Œæœ‰æ•ˆåœ°é€£çµèˆ‡æ‡‰ç”¨æ•™è‚²ç†è«–ã€‚",
                            "10. å¸«å‚…æ ¡é•·èƒ½å¼•å°åˆä»»æ ¡é•·å»ºç«‹æ¸…æ™°çš„å°ˆæ¥­è‡ªæˆ‘èªåŒã€‚"
                        ];
                        qE.forEach((t, i) => document.write(createLikert(`E${i+1}`, t)));
                    </script>
                </div>
            </fieldset>

            <!-- é–‹æ”¾å¼å•é¡Œ -->
            <fieldset class="fieldset-open-questions">
                <legend>åƒã€é–‹æ”¾å¼å•é¡Œ</legend>
                <div class="form-group">
                    <label for="openQ1">1. æ‚¨å°ç›®å‰åœ‹æ°‘ä¸­å°å­¸æ ¡é•·å¸«å¾’åˆ¶åº¦æœ‰ä½•å…·é«”å»ºè­°æˆ–æ”¹é€²æ–¹å‘ï¼Ÿ</label>
                    <textarea id="openQ1" name="openQ1" rows="5" placeholder="è«‹åœ¨æ­¤è¼¸å…¥æ‚¨çš„å¯¶è²´æ„è¦‹..."></textarea>
                </div>
                <div class="form-group">
                    <label for="openQ2">2. æ‚¨èªç‚ºå¸«å¾’åˆ¶å°æ ¡é•·å°ˆæ¥­ç™¼å±•çš„å¹«åŠ©ç‚ºä½•ï¼Ÿè«‹ç°¡è¿°æ‚¨çš„çœ‹æ³•æˆ–ç¶“é©—ã€‚</label>
                    <textarea id="openQ2" name="openQ2" rows="5" placeholder="è«‹åœ¨æ­¤è¼¸å…¥æ‚¨çš„å¯¶è²´æ„è¦‹..."></textarea>
                </div>
                <div class="form-group">
                    <label for="openQ3">3. æ‚¨èªç‚ºå½±éŸ¿æ‚¨åƒèˆ‡å¸«å¾’åˆ¶çš„å…¶ä»–å› ç´ æœ‰å“ªäº›ï¼Ÿ</label>
                    <textarea id="openQ3" name="openQ3" rows="5" placeholder="è«‹åœ¨æ­¤è¼¸å…¥æ‚¨çš„å¯¶è²´æ„è¦‹..."></textarea>
                </div>
            </fieldset>

            <!-- é€å‡ºæŒ‰éˆ•èˆ‡ç‹€æ…‹è¨Šæ¯ -->
            <div class="submit-container">
                <button type="submit" id="submitBtn">é€å‡ºå•å·</button>
                <div id="loadingSpinner" style="display: none;">
                    <p>è³‡æ–™é€å‡ºä¸­ï¼Œè«‹ç¨å€™...</p>
                </div>
                <div id="statusMessage" style="display: none;"></div>
            </div>

            <p style="text-align: center; margin-top: 2rem; font-size: 0.9rem; color: #777;">
                æ„Ÿè¬æ‚¨çš„åƒèˆ‡ï¼æ‚¨çš„å¯¶è²´æ„è¦‹å°‡æœ‰åŠ©æ–¼æå‡æ ¡é•·å°ˆæ¥­ç™¼å±•çš„å“è³ªã€‚
            </p>
        </form>
    </div>

    <script>
        // ==========================================
        // ï¼ï¼ï¼è«‹å°‡æ­¤è™•æ›¿æ›ç‚ºæ‚¨çš„ GAS Web App URLï¼ï¼ï¼
        // ==========================================
        const GAS_API_URL = 'https://script.google.com/macros/s/AKfycbwqA9qBigYRK-2YmGeCZeaxJk4SzpWALOc6KABg9mtHJKgeJEZCMEuysWrV4arjPBXH/exec';
        // ==========================================

        // --- District Map Logic ---
        document.addEventListener('DOMContentLoaded', function() {
            const districtMap = document.getElementById('districtMap');
            const hiddenInput = document.getElementById('schoolDistrict');
            const districtError = document.getElementById('districtError');

            if (districtMap) {
                districtMap.addEventListener('click', function(e) {
                    // ä½¿ç”¨ closest ç¢ºä¿é»åˆ°æŒ‰éˆ•å…§éƒ¨çš„æ–‡å­—ä¹Ÿèƒ½è§¸ç™¼
                    const btn = e.target.closest('.district-btn');
                    if (btn) {
                        const selectedValue = btn.dataset.value;
                        hiddenInput.value = selectedValue;
                        const allBtns = districtMap.querySelectorAll('.district-btn');
                        allBtns.forEach(b => b.classList.remove('selected'));
                        btn.classList.add('selected');
                        districtError.style.display = 'none';
                        
                        // ç§»é™¤éŒ¯èª¤æ¨£å¼
                         document.getElementById('districtMap').classList.remove('highlight-error');
                    }
                });
            }
            
            // ç§»é™¤ Radio Button ä¸Šçš„éŒ¯èª¤æ¨£å¼
             const allRadios = document.querySelectorAll('input[type="radio"]');
             allRadios.forEach(radio => {
                 radio.addEventListener('change', function() {
                      const container = this.closest('.form-group, .likert-question');
                      if(container) {
                          container.classList.remove('highlight-error');
                      }
                 });
             });
        });

        // --- Form Submission ---
        document.getElementById('surveyForm').addEventListener('submit', function(e) {
            e.preventDefault();
            const form = this;
            const submitBtn = document.getElementById('submitBtn');
            const loadingSpinner = document.getElementById('loadingSpinner');
            const statusMessage = document.getElementById('statusMessage');
            const hiddenInput = document.getElementById('schoolDistrict');
            const districtError = document.getElementById('districtError');
            
            // 1. é‡ç½®æ‰€æœ‰éŒ¯èª¤æç¤ºèˆ‡æ¨£å¼
            statusMessage.style.display = 'none';
            statusMessage.className = '';
            districtError.style.display = 'none';
            document.querySelectorAll('.highlight-error').forEach(el => el.classList.remove('highlight-error'));

            // 2. æª¢æŸ¥è¡Œæ”¿å€ (éš±è—æ¬„ä½)
            if (!hiddenInput.value) {
                districtError.style.display = 'block';
                const mapContainer = document.getElementById('districtMap');
                
                // å¼·åˆ¶æ²å‹• (CSS scroll-margin-top æœƒè™•ç†åç§»)
                mapContainer.scrollIntoView({ behavior: 'smooth', block: 'center' });
                mapContainer.classList.add('highlight-error');
                
                statusMessage.textContent = 'è«‹é¸æ“‡ã€Œå­¸æ ¡æ‰€å±¬è¡Œæ”¿å€ã€ï¼(è«‹æŸ¥çœ‹ä¸Šæ–¹ç´…æ¡†è™•)';
                statusMessage.className = 'error';
                statusMessage.style.display = 'block';
                
                return;
            }

            // 3. æª¢æŸ¥å…¶ä»–å¿…å¡«æ¬„ä½
            if (!form.checkValidity()) {
                // é¡¯ç¤ºåº•éƒ¨éŒ¯èª¤è¨Šæ¯
                statusMessage.textContent = 'æ‚¨æœ‰éƒ¨åˆ†é¡Œç›®å°šæœªå¡«ç­”ï¼Œå·²è‡ªå‹•æ²å‹•è‡³è©²é¡Œï¼Œè«‹æª¢æŸ¥ç´…è‰²æ¨™ç¤ºè™•ã€‚';
                statusMessage.className = 'error';
                statusMessage.style.display = 'block';

                // æ‰¾åˆ°ç¬¬ä¸€å€‹ç„¡æ•ˆçš„æ¬„ä½
                const invalidElements = form.querySelectorAll(':invalid');
                if (invalidElements.length > 0) {
                    const firstInvalid = invalidElements[0];
                    
                    // å˜—è©¦æ‰¾åˆ°è©²æ¬„ä½çš„ã€Œå®¹å™¨ã€
                    let container = firstInvalid.closest('.likert-question, .form-group');
                    if (!container) container = firstInvalid.parentElement; 
                    
                    // 1. åŠ ä¸ŠéŒ¯èª¤æ¨£å¼
                    container.classList.add('highlight-error');
                    
                    // 2. æ²å‹• (åˆ©ç”¨ CSS çš„ scroll-margin-top è™•ç†åç§»)
                    container.scrollIntoView({ behavior: 'smooth', block: 'center' });
                }
                return;
            }
            
            // 4. æª¢æŸ¥å¾Œç«¯ URL
            if (GAS_API_URL.includes('è«‹åœ¨æ­¤å¡«å…¥')) {
                 statusMessage.textContent = 'éŒ¯èª¤ï¼šå°šæœªè¨­å®šå¾Œç«¯ API ç¶²å€ï¼Œè«‹è¯çµ¡ç®¡ç†å“¡ã€‚';
                 statusMessage.className = 'error';
                 statusMessage.style.display = 'block';
                 alert('ç³»çµ±éŒ¯èª¤ï¼šå°šæœªè¨­å®šå¾Œç«¯ç¶²å€');
                 return;
            }

            // 5. é€å‡ºè³‡æ–™
            submitBtn.disabled = true;
            submitBtn.textContent = 'è™•ç†ä¸­...';
            loadingSpinner.style.display = 'block';

            const formData = new FormData(form);
            const dataObject = {};
            formData.forEach((value, key) => { dataObject[key] = value; });

            fetch(GAS_API_URL, {
                method: 'POST',
                headers: {
                    'Content-Type': 'text/plain;charset=utf-8',
                },
                body: JSON.stringify(dataObject),
            })
            .then(response => {
                 if (!response.ok) {
                     throw new Error(`HTTP error! status: ${response.status}`);
                 }
                 return response.text();
            })
            .then(text => {
                try {
                    return JSON.parse(text);
                } catch (e) {
                    console.error("JSON Parse Error. Raw text:", text);
                    throw new Error('ä¼ºæœå™¨å›å‚³æ ¼å¼éŒ¯èª¤');
                }
            })
            .then(handleSuccess)
            .catch(handleError);
        });

        function handleSuccess(response) {
            const loadingSpinner = document.getElementById('loadingSpinner');
            loadingSpinner.style.display = 'none';
            
            if (response.success) {
                document.getElementById('surveyForm').style.display = 'none';
                window.scrollTo(0, 0);
                const container = document.querySelector('.container');
                container.innerHTML = `
                    <div style="text-align: center; padding: 3rem 2rem;">
                        <div style="font-size: 4rem; margin-bottom: 1rem;">ğŸ‰</div>
                        <h2 style="color: #004a99; margin-bottom: 1rem;">æ„Ÿè¬æ‚¨çš„å¡«å¯«ï¼</h2>
                        <p style="font-size: 1.1rem; color: #555;">æ‚¨çš„å›è¦†å·²æˆåŠŸé€å‡ºï¼Œé€™ä»½è³‡æ–™å°æˆ‘å€‘çš„ç ”ç©¶éå¸¸æœ‰å¹«åŠ©ã€‚</p>
                        <button onclick="window.location.reload()" style="margin-top: 2rem; padding: 0.8rem 2rem; background: #f4f7f6; border: 1px solid #ccc; border-radius: 50px; cursor: pointer; color: #555;">é‡æ–°æ•´ç†é é¢</button>
                    </div>`;
            } else {
                handleError({ message: response.error || 'ä¼ºæœå™¨è™•ç†å¤±æ•—ï¼Œè«‹ç¨å¾Œå†è©¦ã€‚' });
            }
        }

        function handleError(error) {
            const submitBtn = document.getElementById('submitBtn');
            const loadingSpinner = document.getElementById('loadingSpinner');
            const statusMessage = document.getElementById('statusMessage');

            loadingSpinner.style.display = 'none';
            submitBtn.disabled = false;
            submitBtn.textContent = 'é€å‡ºå•å·';

            let errorMsg = (error && error.message) ? error.message : 'é€å‡ºå¤±æ•—ï¼Œè«‹æª¢æŸ¥ç¶²è·¯é€£ç·šã€‚';
            statusMessage.textContent = errorMsg;
            statusMessage.className = 'error';
            statusMessage.style.display = 'block';
            
            // æ²å‹•åˆ°æœ€åº•éƒ¨éŒ¯èª¤è¨Šæ¯
            statusMessage.scrollIntoView({ behavior: 'smooth', block: 'center' });
            console.error('Detailed Error:', error);
        }
    </script>
</body>
</html>
