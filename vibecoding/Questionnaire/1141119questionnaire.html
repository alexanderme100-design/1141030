<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>校長師徒制實施成效問卷</title>
    <style>
        /* --- 樣式保持不變，與之前設計相同 --- */
        :root {
            --primary-color: #004a99;
            --secondary-color: #0056b3;
            --light-gray: #f4f7f6;
            --text-color: #333;
            --border-color: #ccc;
            --shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
        }

        html, body {
            margin: 0;
            padding: 0;
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans TC", "Microsoft JhengHei", sans-serif;
            line-height: 1.6;
            background-color: var(--light-gray);
            color: var(--text-color);
            scroll-behavior: smooth;
        }

        header {
            width: 100%;
            background-color: var(--primary-color);
            color: white;
            padding: 1.5rem 1rem;
            text-align: center;
            font-size: 1.5rem;
            font-weight: 600;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            box-sizing: border-box;
        }

        .container {
            max-width: 800px;
            margin: 2rem auto;
            padding: 2rem;
            background-color: #ffffff;
            border-radius: 8px;
            box-shadow: var(--shadow);
        }

        .description {
            background-color: #f9f9f9;
            border-left: 5px solid var(--primary-color);
            padding: 1rem 1.5rem;
            margin-bottom: 2rem;
            border-radius: 4px;
        }

        fieldset {
            border: 1px solid #ddd;
            border-radius: 8px;
            padding: 1.5rem;
            margin-bottom: 2rem;
            background-color: #fff;
        }

        legend {
            font-size: 1.3rem;
            font-weight: 600;
            color: var(--primary-color);
            padding: 0 0.5rem;
            margin-left: 1rem;
        }

        .form-group { margin-bottom: 1.5rem; }

        .form-group label, .question-text {
            display: block;
            margin-bottom: 0.75rem;
            font-weight: 500;
            font-size: 1.1rem;
        }
        
        .question-note {
            font-size: 0.9rem;
            color: #555;
            margin-top: -0.5rem;
            margin-bottom: 0.75rem;
        }

        .required { color: red; font-weight: bold; margin-left: 4px; }

        /* --- 選項群組 (按鈕風格) --- */
        .options-group {
            display: flex;
            flex-direction: row;
            flex-wrap: wrap;
            gap: 0.75rem;
            align-items: center;
        }

        .options-group label {
            margin-bottom: 0;
            font-weight: 400;
            cursor: pointer;
            padding: 0.6rem 1rem;
            border-radius: 4px;
            transition: all 0.2s ease;
            display: inline-flex;
            align-items: center;
            border: 1px solid #ddd;
            background-color: #fff;
            font-size: 0.95rem;
            user-select: none;
        }

        .fieldset-basic-info .options-group label {
            flex-grow: 1;
            flex-basis: 150px;
            justify-content: center;
        }

        .options-group label:hover {
            background-color: #f0f5ff;
            border-color: var(--primary-color);
        }

        .options-group input[type="radio"] { display: none; }
        
        .options-group label:has(input[type="radio"]:checked) {
            background-color: var(--primary-color);
            color: white;
            border-color: var(--primary-color);
            font-weight: 500;
        }

        input[type="text"], select, textarea {
            width: 100%;
            padding: 0.8rem;
            border: 1px solid var(--border-color);
            border-radius: 4px;
            box-sizing: border-box;
            font-size: 1rem;
        }
        textarea { resize: vertical; min-height: 100px; }

        /* --- District Map Styles --- */
        #districtMap {
            border: 1px solid var(--border-color);
            border-radius: 4px;
            padding: 1rem;
            background-color: #fcfcfc;
        }
        .district-group { margin-bottom: 1rem; }
        .district-group:last-child { margin-bottom: 0; }
        .district-label {
            font-size: 0.9rem;
            font-weight: 500;
            color: #555;
            margin-bottom: 0.75rem;
            padding-bottom: 0.5rem;
            border-bottom: 1px solid #eee;
        }
        .district-grid { display: flex; flex-wrap: wrap; gap: 0.5rem; }
        .district-btn {
            padding: 0.6rem 0.8rem;
            border: 1px solid #ddd;
            border-radius: 4px;
            background-color: #fff;
            cursor: pointer;
            transition: all 0.2s ease;
            font-size: 0.95rem;
            user-select: none;
        }
        .district-btn:hover { background-color: #f0f5ff; border-color: var(--primary-color); }
        .district-btn.selected {
            background-color: var(--primary-color);
            color: white;
            border-color: var(--primary-color);
            font-weight: 500;
        }

        /* --- Likert 量表樣式 --- */
        .likert-question {
            padding-bottom: 1.5rem;
            margin-bottom: 1.5rem;
            border-bottom: 1px solid #f0f0f0;
        }
        .likert-question:last-child { border-bottom: none; }

        .dimension {
            border: 1px solid #ddd;
            border-radius: 8px;
            padding: 1.5rem;
            margin-top: 2.5rem;
            border-left-width: 5px;
            background-color: #fcfcfc;
        }
        
        /* 向度配色 */
        .dimension-1 { background-color: #f0f7ff; border-left-color: #004a99; }
        .dimension-1 h4 { color: #004a99; }
        .dimension-2 { background-color: #f0fff5; border-left-color: #00794a; }
        .dimension-2 h4 { color: #00794a; }
        .dimension-3 { background-color: #fffaf0; border-left-color: #b87400; }
        .dimension-3 h4 { color: #b87400; }
        .dimension-4 { background-color: #f5f0ff; border-left-color: #5a0099; }
        .dimension-4 h4 { color: #5a0099; }
        .dimension-5 { background-color: #f0fdfd; border-left-color: #007a7c; }
        .dimension-5 h4 { color: #007a7c; }

        .dimension .question-note {
            background-color: rgba(255, 255, 255, 0.7);
            padding: 0.75rem;
            border-radius: 4px;
            border: 1px solid #eee;
        }

        .likert-options {
            display: flex;
            flex-wrap: wrap;
            justify-content: space-around;
            margin-top: 0.75rem;
        }

        .likert-options label {
            display: flex;
            flex-direction: column;
            align-items: center;
            text-align: center;
            font-size: 0.9rem;
            padding: 0.5rem;
            border-radius: 8px;
            flex-basis: 70px;
            flex-grow: 1;
            cursor: pointer;
            transition: all 0.2s ease-in-out;
            border: 1px solid #eee;
            background-color: #fafafa;
            user-select: none;
        }
        
        .likert-options label:hover {
             background-color: #f0f5ff;
             border-color: var(--primary-color);
             transform: translateY(-2px);
             box-shadow: var(--shadow);
        }

        .likert-options label:has(input[type="radio"]:checked) {
            background-color: var(--primary-color);
            color: white;
            border-color: var(--secondary-color);
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.15);
            font-weight: 500;
        }
        
        /* 向度特定選中顏色 */
        .dimension-1 .likert-options label:has(input[type="radio"]:checked) { background-color: #004a99; border-color: #004a99; }
        .dimension-2 .likert-options label:has(input[type="radio"]:checked) { background-color: #00794a; border-color: #00794a; }
        .dimension-3 .likert-options label:has(input[type="radio"]:checked) { background-color: #b87400; border-color: #b87400; }
        .dimension-4 .likert-options label:has(input[type="radio"]:checked) { background-color: #5a0099; border-color: #5a0099; }
        .dimension-5 .likert-options label:has(input[type="radio"]:checked) { background-color: #007a7c; border-color: #007a7c; }

        .likert-options input[type="radio"] { display: none; }

        /* Fieldset Colors */
        .fieldset-basic-info { background-color: #f4f8ff; border-left: 5px solid #0056b3; }
        .fieldset-basic-info legend { color: #0056b3; }
        .fieldset-open-questions { background-color: #f5fcf5; border-left: 5px solid #006437; }
        .fieldset-open-questions legend { color: #006437; }

        /* Submit Area */
        .submit-container { text-align: center; margin-top: 2rem; }
        #submitBtn {
            background-color: var(--secondary-color);
            color: white;
            padding: 0.8rem 2rem;
            border: none;
            border-radius: 4px;
            font-size: 1.2rem;
            font-weight: 500;
            cursor: pointer;
            transition: background-color 0.3s ease, transform 0.1s ease;
        }
        #submitBtn:hover { background-color: var(--primary-color); }
        #submitBtn:active { transform: scale(0.98); }
        #submitBtn:disabled { background-color: #aaa; cursor: not-allowed; }
        #loadingSpinner { font-weight: bold; color: var(--primary-color); margin-top: 1rem; }
        #statusMessage { margin-top: 1.5rem; font-size: 1.1rem; font-weight: bold; padding: 1rem; border-radius: 4px; }
        .success { color: #155724; background-color: #d4edda; border: 1px solid #c3e6cb; }
        .error { color: #721c24; background-color: #f8d7da; border: 1px solid #f5c6cb; }

        /* RWD Mobile */
        @media (max-width: 600px) {
            .container { margin: 0; padding: 1rem; border-radius: 0; box-shadow: none; }
            header { font-size: 1.25rem; padding: 1rem; }
            .likert-options { flex-direction: column; align-items: flex-start; }
            .likert-options label { flex-direction: row; text-align: left; width: 100%; padding: 0.75rem 0.5rem; border: 1px solid #eee; }
            #submitBtn { width: 100%; font-size: 1.1rem; }
        }
    </style>

    <!-- Helper script (Defined in Head to avoid ReferenceError) -->
    <script>
        function createLikert(name, questionText) {
            return `
            <div class="likert-question">
                <p class="question-text">${questionText} <span class="required">*</span></p>
                <div class="likert-options">
                    <label><input type="radio" name="${name}" value="7" required> (7) 極為同意</label>
                    <label><input type="radio" name="${name}" value="6" required> (6) 很同意</label>
                    <label><input type="radio" name="${name}" value="5" required> (5) 同意</label>
                    <label><input type="radio" name="${name}" value="4" required> (4) 普通</label>
                    <label><input type="radio" name="${name}" value="3" required> (3) 不同意</label>
                    <label><input type="radio" name="${name}" value="2" required> (2) 很不同意</label>
                    <label><input type="radio" name="${name}" value="1" required> (1) 極不同意</label>
                </div>
            </div>`;
        }
    </script>
</head>
<body>

    <header>中小學階段校長師徒制實施成效問卷V3</header>

    <div class="container">
        <div class="description">
            <p><strong>敬愛的校長您好：</strong></p>
            <p>這是一份有關校長師徒制實施成效的問卷，希望借重您的智慧與經驗，就您實際的經驗依符合程度來檢視這些題目。</p>
            <p>本問卷旨在深入了解中小學階段校長對於「校長師徒制」的看法與感受程度。您的寶貴意見將是未來相關政策研擬與實務推動的重要參考。</p>
        </div>

        <form id="surveyForm">

            <!-- 壹、基本資料 -->
            <fieldset class="fieldset-basic-info">
                <legend>壹、基本資料</legend>
                <p class="question-note">說明：請依據您的資料狀況，勾選最符合的答案。(<span class="required">*</span> 為必填)</p>

                <div class="form-group">
                    <label>性別 <span class="required">*</span></label>
                    <div class="options-group">
                        <label><input type="radio" name="gender" value="男" required> 男</label>
                        <label><input type="radio" name="gender" value="女" required> 女</label>
                    </div>
                </div>

                <div class="form-group">
                    <label>年齡 <span class="required">*</span></label>
                    <div class="options-group">
                        <label><input type="radio" name="age" value="30歲（含）以下" required> 30歲（含）以下</label>
                        <label><input type="radio" name="age" value="31-40歲" required> 31-40歲</label>
                        <label><input type="radio" name="age" value="41-50歲" required> 41-50歲</label>
                        <label><input type="radio" name="age" value="51歲-60歲" required> 51歲-60歲</label>
                        <label><input type="radio" name="age" value="61歲以上" required> 61歲以上</label>
                    </div>
                </div>

                <div class="form-group">
                    <label>最高學歷 <span class="required">*</span></label>
                    <div class="options-group">
                        <label><input type="radio" name="education" value="學士" required> 學士</label>
                        <label><input type="radio" name="education" value="碩士（含40學分班）" required> 碩士（含40學分班）</label>
                        <label><input type="radio" name="education" value="博士" required> 博士</label>
                    </div>
                </div>

                <div class="form-group">
                    <label>擔任校長總年資 <span class="required">*</span></label>
                    <div class="options-group">
                        <label><input type="radio" name="seniority" value="4年（含）以下" required> 4年（含）以下</label>
                        <label><input type="radio" name="seniority" value="5-8年" required> 5-8年</label>
                        <label><input type="radio" name="seniority" value="9-12年" required> 9-12年</label>
                        <label><input type="radio" name="seniority" value="13年（含）以上" required> 13年（含）以上</label>
                    </div>
                </div>

                <div class="form-group">
                    <label>服務學校階段別 <span class="required">*</span></label>
                    <div class="options-group">
                        <label><input type="radio" name="schoolLevel" value="國小" required> 國小</label>
                        <label><input type="radio" name="schoolLevel" value="國中" required> 國中</label>
                        <label><input type="radio" name="schoolLevel" value="高中職" required> 高中職</label>
                    </div>
                </div>

                <div class="form-group">
                    <label>學校規模 <span class="required">*</span></label>
                    <div class="options-group">
                        <label><input type="radio" name="schoolSize" value="12班（含）以下" required> 12班（含）以下</label>
                        <label><input type="radio" name="schoolSize" value="13-24班" required> 13-24班</label>
                        <label><input type="radio" name="schoolSize" value="25-47班" required> 25-47班</label>
                        <label><input type="radio" name="schoolSize" value="48班以上" required> 48班以上</label>
                    </div>
                </div>

                <div class="form-group">
                    <label>學校所在地區 <span class="required">*</span></label>
                    <div class="options-group">
                        <label><input type="radio" name="schoolRegion" value="都市型" required> 都市型</label>
                        <label><input type="radio" name="schoolRegion" value="鄉鎮型" required> 鄉鎮型</label>
                        <label><input type="radio" name="schoolRegion" value="偏遠或離島型" required> 偏遠或離島型</label>
                    </div>
                </div>

                <div class="form-group">
                    <label for="schoolDistrict">學校所屬行政區 <span class="required">*</span></label>
                    <input type="hidden" id="schoolDistrict" name="schoolDistrict" value="" required>
                    <div id="districtMap">
                        <div class="district-group">
                            <div class="district-label">直轄市</div>
                            <div class="district-grid">
                                <div class="district-btn" data-value="臺北市">臺北市</div>
                                <div class="district-btn" data-value="新北市">新北市</div>
                                <div class="district-btn" data-value="桃園市">桃園市</div>
                                <div class="district-btn" data-value="臺中市">臺中市</div>
                                <div class="district-btn" data-value="臺南市">臺南市</div>
                                <div class="district-btn" data-value="高雄市">高雄市</div>
                            </div>
                        </div>
                        <div class="district-group">
                            <div class="district-label">縣</div>
                            <div class="district-grid">
                                <div class="district-btn" data-value="新竹縣">新竹縣</div>
                                <div class="district-btn" data-value="苗栗縣">苗栗縣</div>
                                <div class="district-btn" data-value="彰化縣">彰化縣</div>
                                <div class="district-btn" data-value="南投縣">南投縣</div>
                                <div class="district-btn" data-value="雲林縣">雲林縣</div>
                                <div class="district-btn" data-value="嘉義縣">嘉義縣</div>
                                <div class="district-btn" data-value="屏東縣">屏東縣</div>
                                <div class="district-btn" data-value="宜蘭縣">宜蘭縣</div>
                                <div class="district-btn" data-value="花蓮縣">花蓮縣</div>
                                <div class="district-btn" data-value="臺東縣">臺東縣</div>
                                <div class="district-btn" data-value="澎湖縣">澎湖縣</div>
                                <div class="district-btn" data-value="金門縣">金門縣</div>
                                <div class="district-btn" data-value="連江縣">連江縣</div>
                            </div>
                        </div>
                        <div class="district-group">
                            <div class="district-label">市 (省轄市)</div>
                            <div class="district-grid">
                                <div class="district-btn" data-value="基隆市">基隆市</div>
                                <div class="district-btn" data-value="新竹市">新竹市</div>
                                <div class="district-btn" data-value="嘉義市">嘉義市</div>
                            </div>
                        </div>
                    </div>
                    <div id="districtError" style="color: red; font-size: 0.9rem; display: none; margin-top: 5px;">請選擇一個行政區。</div>
                </div>

                <div class="form-group">
                    <label>您是否曾參與師徒制度 <span class="required">*</span></label>
                    <div class="options-group">
                        <label><input type="radio" name="hasMentorship" value="是" required> 是</label>
                        <label><input type="radio" name="hasMentorship" value="否" required> 否</label>
                    </div>
                </div>

                <div class="form-group">
                    <label>您曾參與師徒制度配對方式為何 <span class="required">*</span></label>
                    <div class="options-group">
                        <label><input type="radio" name="mentorshipType" value="正式官方師徒制" required> 正式官方師徒制</label>
                        <label><input type="radio" name="mentorshipType" value="非正式固定師徒關係" required> 非正式固定師徒關係</label>
                        <label><input type="radio" name="mentorshipType" value="同儕教練/學習社群" required> 同儕教練/學習社群</label>
                        <label><input type="radio" name="mentorshipType" value="尚未參與" required> 尚未參與</label>
                    </div>
                </div>
            </fieldset>

            <!-- 貳、量表 -->
            <fieldset>
                <legend>貳、校長師徒制實施成效量表</legend>
                <div class="description">
                    <p><strong>說明：</strong>請您對【 中小學階段 校長師徒制實施成效】問卷，共五個向度的同意程度，依個人認同程度在□內打「」。(<span class="required">*</span> 為必填)</p>
                </div>
                
                <div class="likert-options" style="padding: 0.5rem 1rem; background: #f9f9f9; border-radius: 4px; margin-bottom: 1.5rem; justify-content: space-around; flex-wrap: wrap;">
                    <span style="font-size: 0.9rem;">(7) 極為同意</span>
                    <span style="font-size: 0.9rem;">(6) 很同意</span>
                    <span style="font-size: 0.9rem;">(5) 同意</span>
                    <span style="font-size: 0.9rem;">(4) 普通</span>
                    <span style="font-size: 0.9rem;">(3) 不同意</span>
                    <span style="font-size: 0.9rem;">(2) 很不同意</span>
                    <span style="font-size: 0.9rem;">(1) 極不同意</span>
                </div>

                <!-- 向度一 -->
                <div class="dimension dimension-1">
                    <h4>向度一：校務經營與危機處理</h4>
                    <p class="question-note">定義：本向度聚焦於師傅校長在協助初任校長應對「校務經營」全貌的指導成效。</p>
                    
                    <script>
                       const qA = [
                         "1. 師傅校長能提供初任校長學校總務行政事務的專業指導。",
                         "2. 師傅校長能引導初任校長做有效的時間管理，提升行政處理效能。",
                         "3. 師傅校長能引導初任校長建立全方位的校園安全管理系統。",
                         "4. 師傅校長能提升初任校長在重大壓力情境中的策略性決策能力。",
                         "5. 師傅校長能提升初任校長在危機事件中的整合性處理能力。",
                         "6. 師傅校長能引導初任校長在校園安全事件中，熟稔標準作業處理流程。",
                         "7. 師傅校長能引導初任校長進行校內有限資源的策略性分配及運用。",
                         "8. 師傅校長能引導初任校長從錯誤決策中進行事後檢討汲取經驗。",
                         "9. 師傅校長能引導初任校長運用有效的授權策略，以促進學校行政順暢運作。",
                         "10. 師傅校長能引導初任校長在危機後，妥適安撫師生情緒的輔導。"
                       ];
                       qA.forEach((t, i) => document.write(createLikert(`A${i+1}`, t)));
                    </script>
                </div>

                <!-- 向度二 -->
                <div class="dimension dimension-2">
                    <h4>向度二：師徒關係與關懷支持</h4>
                    <p class="question-note">定義：本向度聚焦於師徒互動的品質與情感功能。</p>
                    <script>
                        const qB = [
                            "1. 師傅校長與初任校長有良好的信任關係。",
                            "2. 師傅校長與初任校長有安全信賴的互動氛圍，可以坦誠交流。",
                            "3. 師傅校長與初任校長在互動過程中，能彼此相互傾聽與尊重。",
                            "4. 師傅校長有同理心，提供初任校長溫暖且有效的情感支持。",
                            "5. 師傅校長能有效緩解初任校長的孤立感與工作焦慮。",
                            "6. 師傅校長能提升初任校長的工作滿意度。",
                            "7. 師傅校長能主動關懷初任校長的身心健康，展現出公事外的支持。",
                            "8. 師傅校長能幫助初任校長應對最具挑戰性的工作壓力。",
                            "9. 師傅校長所營造的關係氛圍，讓初任校長無後顧之憂尋求協助與指導。",
                            "10. 師傅校長能給予積極肯定與賦能，強化初任校長辦學自信心。"
                        ];
                        qB.forEach((t, i) => document.write(createLikert(`B${i+1}`, t)));
                    </script>
                </div>

                <!-- 向度三 -->
                <div class="dimension dimension-3">
                    <h4>向度三：教學領導與文化塑造</h4>
                    <p class="question-note">定義：本向度旨在檢視師傅校長在協助初任校長發展教學領導、設定教學方向等核心教育工作的成效。</p>
                     <script>
                        const qC = [
                            "1. 師傅校長能引導初任校長發展課程與教學領導的專業能力。",
                            "2. 師傅校長能引導初任校長釐定學校教學發展方向。",
                            "3. 師傅校長能引導初任校長發展實踐學校願景與特色。",
                            "4. 師傅校長能提供初任校長形塑或轉化學校組織文化的有效策略。",
                            "5. 師傅校長能引導初任校長擬定有效推動學校教學品質改進計畫。",
                            "6. 師傅校長能引導初任校長透過系統性的教師專業發展，營造校園的學習型組織文化。",
                            "7. 師傅校長能提供有效的激勵策略，以提升教師的專業投入與動機。",
                            "8. 師傅校長能引導初任校長營造一個正向積極的學校文化。",
                            "9. 師傅校長能引導初任校長調整學校組織架構，以有效支持核心教學任務。",
                            "10. 師傅校長能引導初任校長善用影響力，循序漸進地推動教學變革。"
                        ];
                        qC.forEach((t, i) => document.write(createLikert(`C${i+1}`, t)));
                    </script>
                </div>

                <!-- 向度四 -->
                <div class="dimension dimension-4">
                    <h4>向度四：人際溝通與關係建立</h4>
                    <p class="question-note">定義：本向度旨在評估師傅校長在指導初任校長如何與利害關係人建立良好關係的成效。</p>
                    <script>
                        const qD = [
                            "1. 師傅校長能引導初任校長與校內外關鍵利害關係人，建立正向的信任關係。",
                            "2. 師傅校長能引導初任校長運用有效的溝通策略，以促進同仁間的專業對話與合作。",
                            "3. 師傅校長能引導初任校長展現有效的團隊領導力，以凝聚共識並提振士氣。",
                            "4. 師傅校長能引導初任校長建立校內正向的溝通機制，營造組織內的互信氛圍。",
                            "5. 師傅校長能引導初任校長有效處理親師生之間的互動議題，以建立穩固的教育夥伴關係。",
                            "6. 師傅校長能引導初任校長透過賦權增能，來提升行政團隊的整體合作效能。",
                            "7. 師傅校長能引導初任校長有效經營與校內外社群的和諧關係。",
                            "8. 師傅校長能提供建立穩固親師合作夥伴關係的有效策略。",
                            "9. 師傅校長能引導初任校長以公平、審慎的原則，處理教職員的人事議題。",
                            "10. 師傅校長能引導初任校長與主管機關及昔日同仁建立有效的工作關係。"
                        ];
                        qD.forEach((t, i) => document.write(createLikert(`D${i+1}`, t)));
                    </script>
                </div>

                <!-- 向度五 -->
                <div class="dimension dimension-5">
                    <h4>向度五：專業反思與自主成長</h4>
                    <p class="question-note">定義：本向度旨在探討師徒制是否能引導初任校長進行深層問題診斷、反思性思考。</p>
                    <script>
                        const qE = [
                            "1. 師傅校長能引導初任校長運用反思性提問，深入診斷問題根源。",
                            "2. 師傅校長能提升初任校長在複雜情境的反思與洞察能力。",
                            "3. 師傅校長能提升初任校長的專業自主性、獨立學習及解決問題的能力。",
                            "4. 師傅校長能引導初任校長在領導專業技能上的實質成長。",
                            "5. 師傅校長能引導初任校長從多元視角分析方案利弊。",
                            "6. 師傅校長能協助初任校長從實務經驗中彰顯個人的領導哲學。",
                            "7. 師傅校長能引導初任校長運用系統性思考來分析與解決問題。",
                            "8. 師傅校長能引導初任校長，將個人專業發展與學校永續發展的目標相結合。",
                            "9. 師傅校長能引導初任校長在行政實務中，有效地連結與應用教育理論。",
                            "10. 師傅校長能引導初任校長建立清晰的專業自我認同。"
                        ];
                        qE.forEach((t, i) => document.write(createLikert(`E${i+1}`, t)));
                    </script>
                </div>
            </fieldset>

            <!-- 開放式問題 -->
            <fieldset class="fieldset-open-questions">
                <legend>參、開放式問題</legend>
                <div class="form-group">
                    <label for="openQ1">1. 您對目前國民中小學校長師徒制度有何具體建議或改進方向？</label>
                    <textarea id="openQ1" name="openQ1" rows="5" placeholder="請在此輸入您的寶貴意見..."></textarea>
                </div>
                <div class="form-group">
                    <label for="openQ2">2. 您認為師徒制對校長專業發展的幫助為何？請簡述您的看法或經驗。</label>
                    <textarea id="openQ2" name="openQ2" rows="5" placeholder="請在此輸入您的寶貴意見..."></textarea>
                </div>
                <div class="form-group">
                    <label for="openQ3">3. 您認為影響您參與師徒制的其他因素有哪些？</label>
                    <textarea id="openQ3" name="openQ3" rows="5" placeholder="請在此輸入您的寶貴意見..."></textarea>
                </div>
            </fieldset>

            <!-- 送出按鈕與狀態訊息 -->
            <div class="submit-container">
                <button type="submit" id="submitBtn">送出問卷</button>
                <div id="loadingSpinner" style="display: none;">
                    <p>資料送出中，請稍候...</p>
                </div>
                <div id="statusMessage" style="display: none;"></div>
            </div>

            <p style="text-align: center; margin-top: 2rem; font-size: 0.9rem; color: #777;">
                感謝您的參與！您的寶貴意見將有助於提升校長專業發展的品質。
            </p>
        </form>
    </div>

    <script>
        // ==========================================
        // ！！！請將此處替換為您的 GAS Web App URL！！！
        // ==========================================
        const GAS_API_URL = 'https://script.google.com/macros/s/AKfycbwEMPuMfbLI_XDStirHKYLBaJlyJy01dr_vChF-041ek_DvpcnypXhgsh-aAb4g2yjS/exec';
        // ==========================================

        // --- District Map Logic ---
        document.addEventListener('DOMContentLoaded', function() {
            const districtMap = document.getElementById('districtMap');
            const hiddenInput = document.getElementById('schoolDistrict');
            const districtError = document.getElementById('districtError');

            if (districtMap) {
                districtMap.addEventListener('click', function(e) {
                    if (e.target.classList.contains('district-btn')) {
                        const selectedValue = e.target.dataset.value;
                        hiddenInput.value = selectedValue;
                        const allBtns = districtMap.querySelectorAll('.district-btn');
                        allBtns.forEach(btn => btn.classList.remove('selected'));
                        e.target.classList.add('selected');
                        districtError.style.display = 'none';
                    }
                });
            }
        });

        // --- Form Submission ---
        document.getElementById('surveyForm').addEventListener('submit', function(e) {
            e.preventDefault();
            const form = this;
            const submitBtn = document.getElementById('submitBtn');
            const loadingSpinner = document.getElementById('loadingSpinner');
            const statusMessage = document.getElementById('statusMessage');
            const hiddenInput = document.getElementById('schoolDistrict');
            const districtError = document.getElementById('districtError');
            
            statusMessage.style.display = 'none';
            statusMessage.className = '';
            districtError.style.display = 'none';

            // Custom validation for hidden input
            if (!hiddenInput.value) {
                districtError.style.display = 'block';
                districtError.scrollIntoView({ behavior: 'smooth', block: 'center' });
                statusMessage.textContent = '您有必填欄位尚未完成，請檢查紅色提示的欄位。';
                statusMessage.className = 'error';
                statusMessage.style.display = 'block';
                return;
            }

            if (!form.checkValidity()) {
                form.reportValidity();
                return;
            }
            
            if (GAS_API_URL.includes('請在此填入')) {
                 statusMessage.textContent = '錯誤：尚未設定後端 API 網址，請聯絡管理員。';
                 statusMessage.className = 'error';
                 statusMessage.style.display = 'block';
                 return;
            }

            submitBtn.disabled = true;
            submitBtn.textContent = '處理中...';
            loadingSpinner.style.display = 'block';

            const formData = new FormData(form);
            const dataObject = {};
            formData.forEach((value, key) => { dataObject[key] = value; });

            // 改用 fetch 發送 POST 請求到 Google Apps Script
            fetch(GAS_API_URL, {
                method: 'POST',
                // 這裡使用 text/plain 是為了避免 CORS preflight (OPTIONS) 請求
                // GAS 對複雜的 CORS 請求支援度有限，使用 text/plain + JSON字串 是最穩定的解法
                headers: {
                    'Content-Type': 'text/plain;charset=utf-8',
                },
                body: JSON.stringify(dataObject),
            })
            .then(response => response.json())
            .then(handleSuccess)
            .catch(handleError);
        });

        function handleSuccess(response) {
            const loadingSpinner = document.getElementById('loadingSpinner');
            loadingSpinner.style.display = 'none';
            
            if (response.success) {
                document.getElementById('surveyForm').style.display = 'none';
                window.scrollTo(0, 0);
                const container = document.querySelector('.container');
                container.innerHTML = `
                    <div style="text-align: center; padding: 2rem;">
                        <h2 style="color: #155724;">✔ 感謝填寫！</h2>
                        <p>您的回覆已成功送出。</p>
                    </div>`;
            } else {
                handleError({ message: response.error || '伺服器處理失敗，請稍後再試。' });
            }
        }

        function handleError(error) {
            const submitBtn = document.getElementById('submitBtn');
            const loadingSpinner = document.getElementById('loadingSpinner');
            const statusMessage = document.getElementById('statusMessage');

            loadingSpinner.style.display = 'none';
            submitBtn.disabled = false;
            submitBtn.textContent = '送出問卷';

            statusMessage.textContent = (error && error.message) ? error.message : '送出失敗，請檢查網路連線。';
            statusMessage.className = 'error';
            statusMessage.style.display = 'block';
            console.error('Error:', error);
        }
    </script>
</body>
</html>



